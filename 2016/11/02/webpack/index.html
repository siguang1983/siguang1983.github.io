<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>webpack | 大排档</title>
    <meta name="author" content="siguang(厨子)" />
    <meta name="version" content="1.0.0" />
    <meta name="keywords" content="" />
    <meta name="description" content="模块化模块化分为AMD、CMD、CommonJS、ES6四类

一、CommonJS 

    Node、webpack使用的CommonJS规范, require加载是同步的

    // 导入
    const moduleA = require(&amp;apos;./moduleA&amp;apos;);
    moduleA.someFun(1,2);            // 需要等moduleA加载后在执行，这里是同步

    // 导出
    module.exports = mo" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <meta name="baidu-site-verification" content="F0CXvmUgA9" />

    
    
    <link rel="icon" href="/favicon.png">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <div class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <button id="open-panel" class="open-panel"><i class="icon-library"></i></button>

    <nav class="nav-inner">

        
        
        <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
        </li>
        
        
        
        <li class="nav-item nav-item-tag">
            <a id="nav-tag" class="nav-link" href="#">标签</a>
            <div id="nav-tags" class="nav-tag-wrap">
                <i class="nav-tag-arrow"></i>
                
  <div class="widget-wrap">
    <h3 class="widget-title">
        <i class="icon-tag vm"></i>
        <span class="vm">Labels</span>
    </h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS3/">CSS3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6/">ES6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Egg-js/">Egg.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML-CSS/">HTML/CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP详解/">HTTP详解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/">Jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Less/">Less</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mongoose/">Mongoose</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/">React Native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sass/">Sass</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Weex/">Weex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mock数据/">mock数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/函数式编程/">函数式编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端优化/">前端优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端插件/">前端插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端插件类/">前端插件类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端构建工具/">前端构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微信小程序/">微信小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务器/">服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务端开发/">服务端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板引擎/">模板引擎</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器内核/">浏览器内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端积累/">移动端积累</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/经济学/">经济学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/金融/">金融</a></li></ul>
    </div>
  </div>


            </div>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/archives">归档</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/atom.xml">订阅</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/about">关于</a>
        </li>
        
        
        

    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://siguang1983.github.io"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#模块化"><span class="toc-number">1.</span> <span class="toc-text">模块化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#构建工具的什么用"><span class="toc-number">2.</span> <span class="toc-text">构建工具的什么用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack安装和命令"><span class="toc-number">3.</span> <span class="toc-text">webpack安装和命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Entry"><span class="toc-number">4.</span> <span class="toc-text">Entry</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Output"><span class="toc-number">5.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Loader"><span class="toc-number">6.</span> <span class="toc-text">Loader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#resolve"><span class="toc-number">7.</span> <span class="toc-text">resolve</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#plugins"><span class="toc-number">8.</span> <span class="toc-text">plugins</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#devServer"><span class="toc-number">9.</span> <span class="toc-text">devServer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#devServer的执行命令"><span class="toc-number">10.</span> <span class="toc-text">devServer的执行命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack与gulp"><span class="toc-number">11.</span> <span class="toc-text">webpack与gulp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Source-Map"><span class="toc-number">12.</span> <span class="toc-text">Source Map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常用的处理g"><span class="toc-number">13.</span> <span class="toc-text">常用的处理g</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解决问题"><span class="toc-number">14.</span> <span class="toc-text">解决问题</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            webpack
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="/2016/11/02/webpack/">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2016-11-02T03:06:16.000Z" itemprop="datePublished">2016-11-02</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/前端构建工具/">前端构建工具</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h4 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h4><pre><code>模块化分为AMD、CMD、CommonJS、ES6四类

一、CommonJS 

    Node、webpack使用的CommonJS规范, require加载是同步的

    // 导入
    const moduleA = require(&apos;./moduleA&apos;);
    moduleA.someFun(1,2);            // 需要等moduleA加载后在执行，这里是同步

    // 导出
    module.exports = moduleA.someFunc


二、AMD 异步加载模块

    可异步加载依赖模块，可并行加载多个依赖，可以运行浏览器和node环境下，缺点是需要加载AMD的库才能使用，常用的require.js

    // 定义模块
    define(&apos;moduleA&apos;, [依赖文件], function(jquery){
            var someFun = (x, y) =&gt; { return x + y}
            return {
                someFun,
            }
    })

    // 导入和使用
    require([&apos;moduleA&apos;], function(moduleA){
        module.someFun(1,2);
    })


三、ES6

    JS的标准化模块加载，会逐渐的取代commonJS和AMD

    // 导入
    import React from &apos;react&apos;
    import ReactDOM, { render } from &apos;react-dom&apos;;

    // 导出
    export function hello(){ ... }
    export default {
        ...
    }
    export { fn1, fn2 }


四、CMD 同步加载模块

    代表seajs

    // 定义模块
    define(function(require,exports,module){
        var $ = require(&apos;jquery&apos;);        // 用来加载模块

        exports.sayHello = function(){    // 导出的接口
            ...
        }
    });
</code></pre><h4 id="构建工具的什么用"><a href="#构建工具的什么用" class="headerlink" title="构建工具的什么用"></a>构建工具的什么用</h4><pre><code>1、代码转换 - 将ES6转ES5, 将SCSS转成css

2、文件优化 - 压缩JS、CSS、HTML代码，压缩合并图片

3、代码分割 - 提取多个页面的公共代码，提取首屏不需要执行代码，其它的异步加载

4、模块合并 - 将多个模块合并成一个文件

5、自动刷新 - 监听本地代码变化，并自动构建和刷新浏览器

6、代码校验 - 校验代码是否符合规范

7、自动发布 - 自动构建出线上发布代码并传输给发布系统
</code></pre><h4 id="webpack安装和命令"><a href="#webpack安装和命令" class="headerlink" title="webpack安装和命令"></a>webpack安装和命令</h4><pre><code>$ npm i -D webpack webpack-cli         // 安装稳定版本，4版本以上需要装webpack-cli, -D是--save-dev的缩写

    npm i -D webpack@3.10.0                  // 安装指定版本
</code></pre><p>  $ touch webpack.config.js            // 创建配置文件</p>
<pre><code>一、配置npm运行命令

    &quot;scripts&quot;: {
        &quot;start&quot;: &quot;webpack --config webpack.config.js&quot;
    }
    $ npm start         // 执行


二、webpack命令

    1、webpack            // 最基本的启动webpack命令

    2、webpack --config XXX.js   // 如果默认的配置文件不叫webpack.config.js，就需要在这指定配置文件的名称

        script: {
            &quot;build&quot;: &quot;webpack --config production.config.js&quot;,
            &quot;dev&quot;: &quot;webpack --config development.config.js&quot;
        }

    3、webpack -w         // watch方法，时实预览进行打包 相当于 --watch 

    4、webpack -p         // 对打包后的文件进行压缩

    5、webpack -d         // 提供SourceMaps，方便调试

    6、webpack --colors     // 输出结果带彩色，比如: 会用红色显示耗时较长的步骤

    7、webpack --profile // 输出性能数据，可以看到每一步的耗时

    8、webpack --display-modules     // 默认情况下 node_modules 下的模块会被隐藏，加上这个参数可以显示这些被隐藏的模块

    9、webpack --progress --colors   // 展示一些进度条，同时增加颜色

    10、webpack --display-error-details    // 打印出错在哪个文件和行
</code></pre><h4 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h4><pre><code>entry是配置模块的入口，执行构建开始时递归解析所有的入口依赖，配置值: string | object | array

// 单入口
module.exports = {
    entry: &apos;./src/main.js&apos;
}

// 多入口
module.exports = {
    entry: {
        main: [&quot;./main.js&quot;, &quot;./list.js&quot;]
    }
}

// 多入口，app(应用主入口)，vendors(公共库)入口
module.exports = {
    entry: {
        main: &apos;./src/main.js&apos;,
        list: &apos;./src/list.js&apos;,
        vendors: &apos;./src/jquery.js&apos;                // 加载第三方模块
    }
}
</code></pre><h4 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h4><pre><code>配置 output 选项可以控制 webpack 如何向硬盘写入编译文件

output的配置属性:

1、path: 输出的目录，绝对路径

2、filename: 用于输出文件的文件名

    变量: 1) id chunk 的唯一标识从0开始      2）name chunk 的名称        3）hash 输出hash值        4）chunkhash 内容的hash值

    filename: &apos;bundle.js&apos;

    filename: &apos;[name].js&apos;            // 用于多入口

    filename: &apos;[chunkhash].js&apos;    // 一个随机数，入口为entry chunk

    filename: &apos;[name].js[hash]&apos;    // 带hash值 [hash:8] 代表8位的hash,默认20位

3、publicPath: 复杂项目里会有一些构建出的资源需要异步加载，加载这些异步资源需要对应的URL

    output: {
        filename: &apos;[name]_[chunkhash:8].js&apos;,
        publicPath: &apos;https://cdn.example.com/assets/&apos;            // 发布到线上的HTML &lt;script src=&quot;https://cdn.example.com/assets/main.12345678.js&quot;&lt;/script&gt;
    }
</code></pre><h4 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h4><pre><code>它的基本工作流是将一个文件以字符串的形式读入，对其进行语法分析及转换, 预处理 CoffeeScript、    TypeScript、ESNext (Babel)、Sass、Less、Stylus

1、rules: 配置模块的读取和解析，将所有引用资源(.css、.html、.scss、.jpg)作为模块处理

2、条件匹配: 通过test、include、exclude三个配置项来选中loader规则文件

    test: 匹配哪些文件

    include: 指定一个目录下的所有文件，可以加快webpack的搜索速度

    exclude: 排除某个目录，不在这个目录搜索文件

3、应用规则: 对选中的文件通过usr配置来应用loader

4、重置顺序: 默认从右向左执行, 通过enforce选项将其中一个loader的顺序放到最前或最后

module: {
rules: [
        {
    test: /(\.jsx|\.js)$/,
    use: {
      loader: &quot;babel-loader&quot;,
    },
            include: [path.resolve(__dirname, &apos;src)],        // 只在src目录下搜索js文件
  }
  {
    test: /\.css$/,
    use: [&quot;style-loader&quot;, &quot;css-loader?minimize&quot;, &quot;sass-loader&quot;],        // minimize 压缩css
            exclude: [/node_modules/]                // 除了node_modules目录不搜索
  }
]
</code></pre><p>  }</p>
<pre><code>插件: npm install --save-dev css-loader
</code></pre><h4 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h4><pre><code>webpack启动后会从入口找出所有的依赖模块，resolve配置如何寻找模块对应的文件

1、alias 让模块引入变得简单

    import $ from &apos;/js/lib/jquery.min.js&apos;;      开发中需要引入jquery就需要写这类路径

    通过alias来解决
    resolve: {
        alias: {
            jquery: path.resolve(__dirname, &quot;/js/lib/jquery.min.js&quot;),
        },
        extensions: [&apos;&apos;, &apos;.js&apos;, &apos;.vue&apos;, &apos;.scss&apos;, &apos;.css&apos;]             //设置require或import的时候可以不需要带后缀
    }

    引用
    import $ from &apos;jquery&apos;;        // jquery就会被替换成依赖的路径
</code></pre><h4 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h4><pre><code>plugins扩展webpack功能

一、webpack自带插件，可以直接使用

    pulgins: [
        new webpack.optimize.UglifyJsPlugin(),
        new webpack.optimize.CommonsChunkPlugin({    // webpack自带插件在webpack.optimize内
            name: &apos;vendor&apos;,                                // 上面入口定义的节点组
            filename: &apos;jquery.vendor.js?[hash]&apos;     // 最后生成的文件名
        })
    ]

二、非自身插件，需要先调用插件

    例: main.js

        require(&apos;./main.css&apos;)
        const show = require(&apos;./show.js)
        show(1,2)

    webpack.config.js
    // 将引用的css文件提取出来 
    const ExtractTextPlugin = require(&apos;extract-text-webpack-plugin&apos;);        

    pulgins: [
        new ExtractTextPlugin({
            filename: &apos;[name].[contenthash:8].css&apos;,            // main.11ad8d2c.css
            allChunks: true,
        })
    ]

webpack插件列表: https://www.webpackjs.com/plugins/
</code></pre><h4 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h4><pre><code>webpack-dev-server - 创建一个本地服务，并能设置代理服务，并且能够实时重新加载
</code></pre><p>  一、安装webpack-dev-server</p>
<pre><code>$ npm i --save-dev webpack-dev-server
</code></pre><p>  二、创建文件</p>
<pre><code>// 创建项目目录
$ mkdir webpack_base_demo &amp;&amp; cd webpack_base_demo      

// 创建配置文件
$ touch README.md  .gitignore  .babelrc  webpack.config.js

// 创建package.json
$ npm init 

// 配置.babelrc文件
{
    &quot;presets&quot;: [&quot;react&quot;, &quot;env&quot;],
    &quot;env&quot;: {
        &quot;development&quot;: {
        &lt;!-- &quot;plugins&quot;: [[&quot;react-transform&quot;, {
            &quot;transforms&quot;: [{
                &quot;transform&quot;: &quot;react-transform-hmr&quot;,
                &quot;imports&quot;: [&quot;react&quot;],
                &quot;locals&quot;: [&quot;module&quot;]
            }]
        }]] --&gt;
        }
    }
}
</code></pre><p>  三、安装需要的loader插件</p>
<pre><code>// 如果使用react框架来做项目，先下载包
    $ npm i --save react react-dom

// babel的插件，在react热更新
    $ npm i --save babel-plugin-react-transform react-transform-hmr   

// 使用Babel-loader来解析es6和react
    $ npm i --save babel-core babel-loader babel-preset-env babel-preset-react

    // vue-load - 解析和转换.vue文件，vue-template-compiler - 将vue-load提取出的HTML模板编译成可执行的JS代码，vue项目可直接安装vue-cli
    $ npm vue-load vue-template-compiler

    // jsx转换
    $ npm i --save jsx-loader

    // css模块化，可以在组件中引用指定模块的css文件， import &apos;./main.css&apos;
    $ npm i --save style-loader css-loader 

    // 可以将js和css中的导入的图片替换成正确的地址，同时将文件输出到对应的位置
    $ npm i --save file-loader

    // 将文件的图片经过base64编码后注入js或css中
    $ npm i --save url-loader    

    // 加载SVG
    $ npm i --save svg-loader

    // CSS预处理器  autoprefixer 自动加载前缀
    $ npm i --save less-loader sass-loader
</code></pre><p>  五、package.json配置</p>
<pre><code>&quot;scripts&quot;: {
    &quot;dev&quot;: &quot;webpack-dev-server --hot --inline --progress&quot;,
    &quot;start&quot;: &quot;webpack --progress --profile --colors --config webpack.config.js&quot;,
},
$ npm run start        // 启动开发环境
</code></pre><p>  六、创建生成和开发配置文件</p>
<pre><code>webpack.config.js 开发环境所用配置文件
webpack.pub.config.js  生产环境所用配置文件
</code></pre><p>  七、注意</p>
<pre><code>1、启动两个侦听一个是webpack，一个是devServer，单独启devServer热更新不执行编译，暂没找到解决方法

  $ npm run build

  $ npm run dev
</code></pre><h4 id="devServer的执行命令"><a href="#devServer的执行命令" class="headerlink" title="devServer的执行命令"></a>devServer的执行命令</h4><p>  webpack-dev-server - 在 localhost:8080 建立一个 Web 服务器</p>
<p>  webpack-dev-server –devtool eval - 为你的代码创建源地址。当有任何报错的时候可以让你更加精确地定位到文件和行号</p>
<p>  webpack-dev-server –progress - 显示合并代码进度</p>
<p>  webpack-dev-server –colors - 命令行中显示颜色</p>
<p>  webpack-dev-server –content-base build  // webpack-dev-server服务会默认以当前目录伺服文件，如果设置了content-base的话，服务的根路径则为build目录</p>
<p>  webpack-dev-server –inline  可以自动加上dev-server的管理代码，实现热更新</p>
<p>  webpack-dev-server –hot  开启代码热替换，可以加上HotModuleReplacementPlugin</p>
<p>  webpack-dev-server –port 3000 设置服务端口</p>
<h4 id="webpack与gulp"><a href="#webpack与gulp" class="headerlink" title="webpack与gulp"></a>webpack与gulp</h4><pre><code>gulp 是 task runner，Webpack 是 module bundler

webpack对多入口支持的不太好

gulp没有模块化的支持，需要与webpack结合
</code></pre><h4 id="Source-Map"><a href="#Source-Map" class="headerlink" title="Source Map"></a>Source Map</h4><pre><code>启动时需要加 --devtool source-map 参数重启DevServer后刷新页面，在chrome开发者工具就可以调试源码
</code></pre><h4 id="常用的处理g"><a href="#常用的处理g" class="headerlink" title="常用的处理g"></a>常用的处理g</h4><pre><code>一、css处理

    基本问题包括：

        预编译语言转换
        样式文件挂载方式选择
        代码优化（合并及压缩）
        去除或保留指定格式的注释
        资源定位路径的转换
        响应式布局单位转换【可选】
        模块化【可选】
        处理浏览器兼容【可选】

    1、style-loader - 将处理结束的CSS代码存储在js中，运行时嵌入&amp;lt;style&amp;gt;后挂载至html页面上

    2、css-loader - 加载器，使webpack可以识别css模块

    3、postcss-loader - 加载器，下一篇将详细描述

    4、sass-loader - 加载器，使webpack可以识别scss/sass文件，默认使用node-sass进行编译

    5、mini-css-extract-plugin - 提取单独的css文件插件，4.0版本启用的插件，替代原extract-text-webpack-plugin插件，将处理后的CSS代码提取为独立的CSS文件

    6、optimize-css-assets-webpack-plugin - 插件，实现CSS代码压缩

    7、autoprefixer - 自动化添加跨浏览器兼容前缀


二、Assets 资源（图片、json、xml）

    * 体积压缩
    * 雪碧图合并及引用修正
    * 资源的引用路径自动替换

    1、file-loader - 处理资源文件打包

    2、url-loader - 优化项目中对于资源的引用路径，并设定大小限制

    3、html-loader - html中的静态资源替换

    module: {
        rules: [
            {    
                test:/\.(jpg|png|svg|gif)/,    
                use:[{      
                    loader:&apos;file-loader&apos;,      
                    options:{        
                        outputPath:&apos;imgs/&apos;
                    }
                }]
            },
            {    
                test:/\.(jpg|png|svg|gif)/,    
                use:[{      
                    loader:&apos;url-loader&apos;,      
                    options:{        
                        limit: 8129,            // 限制图片转base64引用大小
                        fallback: &apos;file-loader&apos;,        // 大小limit的交给file-loader处理
                        ouputpath: &apos;imgs/&apos;        // 指定输出路径
                    }
                }]
            }
        ]
    }


三、处理JS和splitChunk

    Js文件打包需求

    * 代码编译（TS或ES6代码的编译）
    * 脚本合并
    * 公共模块识别
    * 代码分割
    * 代码压缩混淆

    1、Babel转换ES6+

        webpack.config.js: 
            module: {    
                rules: [
                    {        
                        test: /\.js$/,        
                        exclude: /node_modules/,        
                        use: [
                            {             
                                loader: &apos;babel-loader&apos;
                            }
                        ]
                    }
                ]
            },

        .bablerc: 
            {    
                &quot;presets&quot;:[
                    [
                        &quot;env&quot;,
                        {            
                            &quot;targets&quot;:{                
                                &quot;browsers&quot;:&quot;last 2 versions&quot;
                            }
                        }
                    ]
                ],    
                &quot;plugins&quot;: [         
                    &quot;babel-plugin-transform-runtime&quot; 
                ]
            }

    2、脚本合并


    3、脚本分割

        为什么要分割，如果遇到比如使用Echarts第三方库或公用文件，这个时候我们不希望把它与业务一起合并到一个文件中，会使这个文件变得非常打，不利于加载


    4、代码混淆压缩

        UglifyJs


    5、splitChunks

        用于提取公用文件或第三方组件，4.0废弃了CommonsChunkPlugin插件，使用optimization.splitChunks和optimization.runtimeChunk来代替

        vendor 加载公用文件或第三方组件

        entry: {
            index: path.resolve(basePath, &apos;js/index.js&apos;),
            list: path.resolve(basePath, &apos;js/list.js&apos;),
            vendors:  path.resolve(basePath, &apos;js/common.js&apos;),
        },

        // 使用optimization，与entry同级，不需要放到plugins内
        optimization: {
            splitChunks: {
                cacheGroups: {
                    commons: {
                        name: &quot;vendors&quot;,
                        chunks: &quot;initial&quot;,
                        minChunks: 2
                    }
                }
            }
        },

        plugins: [
            new HtmlWebpackPlugin({
                title: &apos;首页&apos;, 
                template: path.resolve(basePath, &apos;index.html&apos;),
                filename: path.resolve(buildPath, &apos;index.html&apos;),
                chunks:[&apos;index&apos;, &apos;vendors&apos;],            // 这里加vendors
                inject:&apos;body&apos;,
            })
        ]

        &lt;!-- module.exports = { 
            optimization: {    
                splitChunks: {      
                    chunks: &apos;async&apos;,                        // 默认只作用于异步模块，为`all`时对所有模块生效,`initial`对同步模块有效
                    minSize: 30000,                            // 合并前模块文件的体积
                    minChunks: 1,                                // 最少被引用次数
                    maxAsyncRequests: 5,      
                    maxInitialRequests: 3,      
                    automaticNameDelimiter: &apos;~&apos;,        // 自动命名连接符
                    cacheGroups: {        
                        vendors: {          
                            test: /[\\/]node_modules[\\/]/,          
                            minChunks:1,                        // 敲黑板
                            priority: -10                        // 优先级更高
                        },        
                        default: {          
                            test: /[\\/]src[\\/]js[\\/]/
                            minChunks: 2,                        // 一般为非第三方公共模块
                            priority: -20,          
                            reuseExistingChunk: true
                        }
                    },      
                    runtimeChunk:{         
                         name:&apos;manifest&apos;
                    }
                }
            } --&gt;
</code></pre><h4 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h4><pre><code>1、devServer启动时不编译，分别侦听

2、js文件引用动态生成到html文档内

3、第三方插件或公用组件splitChunk
</code></pre><p>| <a href="https://doc.webpack-china.org/concepts/" target="_blank" rel="noopener">https://doc.webpack-china.org/concepts/</a>        webpack中文网 v3.10.0<br>| <a href="https://www.jianshu.com/p/42e11515c10f" target="_blank" rel="noopener">https://www.jianshu.com/p/42e11515c10f</a><br>| <a href="http://webpack.wuhaolin.cn/" target="_blank" rel="noopener">http://webpack.wuhaolin.cn/</a>                            // book<br>| <a href="https://webpack.js.org/plugins/" target="_blank" rel="noopener">https://webpack.js.org/plugins/</a>                // 自带插件<br>| <a href="https://zhuanlan.zhihu.com/p/32148338" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/32148338</a><br>| <a href="https://blog.csdn.net/keliyxyz/article/details/51571386" target="_blank" rel="noopener">https://blog.csdn.net/keliyxyz/article/details/51571386</a><br>| <a href="http://react-china.org/t/webpack-output-filename-output-chunkfilename/2256/2" target="_blank" rel="noopener">http://react-china.org/t/webpack-output-filename-output-chunkfilename/2256/2</a>   // output.filename 和output.chunkFilename<br>| <a href="http://www.alloyteam.com/2016/02/code-split-by-routes/" target="_blank" rel="noopener">http://www.alloyteam.com/2016/02/code-split-by-routes/</a>  按需加载<br>|<br>| 插件<br>| <a href="http://www.cnblogs.com/haogj/p/5160821.html" target="_blank" rel="noopener">http://www.cnblogs.com/haogj/p/5160821.html</a>     // html-webpack-plugin html多页面构建<br>|<br>| 热更新<br>| <a href="https://github.com/gaearon/react-hot-loader" target="_blank" rel="noopener">https://github.com/gaearon/react-hot-loader</a>    // react<br>| <a href="https://github.com/vuejs/vue-loader" target="_blank" rel="noopener">https://github.com/vuejs/vue-loader</a>            // vue</p>

        
    </section>
</article>



<div class="comments">
    <div id="disqus_thread">
        <p class="comment-tips">国内查看评论需要代理~</p>
    </div>
    <script>
    window.disqus_config = function () {
        this.language = 'zh';
        this.page.url = 'http://siguang1983.github.io/2016/11/02/webpack/';
        this.page.title = 'webpack';
        this.page.identifier = '2016/11/02/webpack/';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://name.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>
</footer>

<script type="text/javascript" src="//s13.cnzz.com/z_stat.php?id=1234567890&amp;web_id=1234567890"></script>


    </div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    
    <script type="text/javascript" src="/js/scrollspy.min.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var nodes = {
                nav: $('#nav'),
                aside: $('#aside'),
                navTags: $('#nav-tags')
            };

            $('#open-panel, #aside-mask').on('click', function() {
                nodes.aside.toggleClass('panel-show');
            });
            $('#nav-tag').on('click', function(event) {
                event.preventDefault();console.log(nodes.navTags.attr('class'))
                nodes.navTags.toggleClass('tag-show');console.log(nodes.navTags.attr('class'))
            })/*.hover(function() {
                nodes.navTags.addClass('tag-show');
            }, function() {
                nodes.navTags.removeClass('tag-show');
            });*/

            
            $(document.body).scrollspy({target: '#aside-inner'});
            
        });
    </script>

</body>
</html>
