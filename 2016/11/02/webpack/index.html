<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>webpack | 大排档</title>
    <meta name="author" content="siguang(厨子)" />
    <meta name="version" content="1.0.0" />
    <meta name="keywords" content="" />
    <meta name="description" content="| AMD、CMD、CommonJS模式| Source Map代码调试| require()、define()、export()| requires.ensure(): 用来按需加载，将文件使用时在进行加载| Vendor: 将库、框架文件与业务分离分别打包| Entry: 入口| Chunk: 出输的名| Output: 打包输出| Loader: 模块转换器| Module: 模块| Reslove: 依赖文件| Plugins: 扩展插件| webpack-dev-server: 本地服" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <meta name="baidu-site-verification" content="F0CXvmUgA9" />

    
    
    <link rel="icon" href="/favicon.png">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <div class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <button id="open-panel" class="open-panel"><i class="icon-library"></i></button>

    <nav class="nav-inner">

        
        
        <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
        </li>
        
        
        
        <li class="nav-item nav-item-tag">
            <a id="nav-tag" class="nav-link" href="#">标签</a>
            <div id="nav-tags" class="nav-tag-wrap">
                <i class="nav-tag-arrow"></i>
                
  <div class="widget-wrap">
    <h3 class="widget-title">
        <i class="icon-tag vm"></i>
        <span class="vm">Labels</span>
    </h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS3/">CSS3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Egg-js/">Egg.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML-CSS/">HTML/CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP详解/">HTTP详解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/">Jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Less/">Less</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/">React Native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sass/">Sass</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Weex/">Weex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mock数据/">mock数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/函数式编程/">函数式编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端优化/">前端优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端插件/">前端插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端插件类/">前端插件类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端构建工具/">前端构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微信小程序/">微信小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务器/">服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务端开发/">服务端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板引擎/">模板引擎</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器内核/">浏览器内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端积累/">移动端积累</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/经济学/">经济学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/金融/">金融</a></li></ul>
    </div>
  </div>


            </div>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/archives">归档</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/atom.xml">订阅</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/about">关于</a>
        </li>
        
        
        

    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://siguang1983.github.io"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#模块化"><span class="toc-number">1.</span> <span class="toc-text">模块化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#构建工具的什么用"><span class="toc-number">2.</span> <span class="toc-text">构建工具的什么用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack安装和命令"><span class="toc-number">3.</span> <span class="toc-text">webpack安装和命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Source-Map"><span class="toc-number">4.</span> <span class="toc-text">Source Map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Entry"><span class="toc-number">5.</span> <span class="toc-text">Entry</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Output"><span class="toc-number">6.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Module"><span class="toc-number">7.</span> <span class="toc-text">Module</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#resolve"><span class="toc-number">8.</span> <span class="toc-text">resolve</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#plugins"><span class="toc-number">9.</span> <span class="toc-text">plugins</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#devServer"><span class="toc-number">10.</span> <span class="toc-text">devServer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack-dev-server-参数"><span class="toc-number">11.</span> <span class="toc-text">webpack-dev-server 参数</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            webpack
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="/2016/11/02/webpack/">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2016-11-02T03:06:16.000Z" itemprop="datePublished">2016-11-02</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/前端构建工具/">前端构建工具</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>| AMD、CMD、CommonJS模式<br>| Source Map代码调试<br>| require()、define()、export()<br>| requires.ensure(): 用来按需加载，将文件使用时在进行加载<br>| Vendor: 将库、框架文件与业务分离分别打包<br>| Entry: 入口<br>| Chunk: 出输的名<br>| Output: 打包输出<br>| Loader: 模块转换器<br>| Module: 模块<br>| Reslove: 依赖文件<br>| Plugins: 扩展插件<br>| webpack-dev-server: 本地服务器，可以设置代理，用来前后端分离跨域</p>
<h4 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h4><pre><code>模块化分为AMD、CMD、CommonJS、ES6四类

一、CommonJS 

    Node、webpack使用的CommonJS规范, require加载是同步的

    // 导入
    const moduleA = require(&apos;./moduleA&apos;);
    moduleA.someFun(1,2);            // 需要等moduleA加载后在执行，这里是同步

    // 导出
    module.exports = moduleA.someFunc


二、AMD 异步加载模块

    可异步加载依赖模块，可并行加载多个依赖，可以运行浏览器和node环境下，缺点是需要加载AMD的库才能使用，常用的require.js

    // 定义模块
    define(&apos;moduleA&apos;, [依赖文件], function(jquery){
            var someFun = (x, y) =&gt; { return x + y}
            return {
                someFun,
            }
    })

    // 导入和使用
    require([&apos;moduleA&apos;], function(moduleA){
        module.someFun(1,2);
    })


三、ES6

    JS的标准化模块加载，会逐渐的取代commonJS和AMD

    // 导入
    import React from &apos;react&apos;
    import ReactDOM, { render } from &apos;react-dom&apos;;

    // 导出
    export function hello(){ ... }
    export default {
        ...
    }
    export { fn1, fn2 }


四、CMD 同步加载模块

    代表seajs

    // 定义模块
    define(function(require,exports,module){
        var $ = require(&apos;jquery&apos;);        // 用来加载模块

        exports.sayHello = function(){    // 导出的接口
            ...
        }
    });
</code></pre><h4 id="构建工具的什么用"><a href="#构建工具的什么用" class="headerlink" title="构建工具的什么用"></a>构建工具的什么用</h4><pre><code>1、代码转换 - 将ES6转ES5, 将SCSS转成css

2、文件优化 - 压缩JS、CSS、HTML代码，压缩合并图片

3、代码分割 - 提取多个页面的公共代码，提取首屏不需要执行代码，其它的异步加载

4、模块合并 - 将多个模块合并成一个文件

5、自动刷新 - 监听本地代码变化，并自动构建和刷新浏览器

6、代码校验 - 校验代码是否符合规范

7、自动发布 - 自动构建出线上发布代码并传输给发布系统
</code></pre><h4 id="webpack安装和命令"><a href="#webpack安装和命令" class="headerlink" title="webpack安装和命令"></a>webpack安装和命令</h4><pre><code>$ npm i -D webpack webpack-cli             // 安装稳定版本，4版本以上需要装webpack-cli, -D是--save-dev的缩写

    npm i -D webpack@3.10.0                        // 安装指定版本


命令

    1、webpack            // 最基本的启动webpack命令

    2、webpack --config XXX.js   //使用另一份配置文件（比如webpack.config2.js）来打包

    3、webpack -w         // watch方法，时实预览进行打包 相当于 --watch 

    4、webpack -p         // 对打包后的文件进行压缩

    5、webpack -d         // 提供SourceMaps，方便调试

    6、webpack --colors     // 输出结果带彩色，比如: 会用红色显示耗时较长的步骤

    7、webpack --profile // 输出性能数据，可以看到每一步的耗时

    8、webpack --display-modules     // 默认情况下 node_modules 下的模块会被隐藏，加上这个参数可以显示这些被隐藏的模块

    9、webpack --progress --colors   // 展示一些进度条，同时增加颜色

    10、webpack --display-error-details    // 打印出错在哪个文件和行
</code></pre><h4 id="Source-Map"><a href="#Source-Map" class="headerlink" title="Source Map"></a>Source Map</h4><pre><code>启动时需要加 --devtool source-map 参数重启DevServer后刷新页面，在chrome开发者工具就可以调试源码
</code></pre><h4 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h4><pre><code>entry是配置模块的入口，执行构建最开始就递归解析所有的入口依赖，可以是 string | object | array

// 单入口
module.exports = {
    entry: &apos;./src/main.js&apos;
}

// 多入口
module.exports = {
    entry: {
        main: [&quot;./main.js&quot;, &quot;./list.js&quot;]
    }
}

// 多入口，app(应用主入口)，vendors(公共库)入口
module.exports = {
    entry: {
        main: &apos;./src/main.js&apos;,
        list: &apos;./src/list.js&apos;,
        vendors: &apos;./src/jquery.js&apos;
    }
}

一、chunk 名称

    如果入口是字符串或数组，output打包出来的都被合并成一个文件，如上（1、2），

    如果入口配置的是对象，打包出来的是以对象每个入口为一个文件，如上（3），打包会出来 main.min.js, list.min.js

    output: {
        path: path.resolve(__dirname, &apos;build/js&apos;),
        filename: &apos;[name].min.js?[hash]&apos;
    }
</code></pre><h4 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h4><pre><code>配置 output 选项可以控制 webpack 如何向硬盘写入编译文件

1、path: 输出的目录，绝对路径

2、filename: 用于输出文件的文件名

    变量: 1) id chunk的唯一标识从0开始      2）name chunk的名称        3）hash 输出hash值        4）chunkhash 内容的hash值

    filename: &apos;bundle.js&apos;

    filename: &apos;[name].js&apos;    // 用于多入口

    filename: &apos;[chunkhash].js&apos;    // 用于长效缓存，入口为entry chunk

    filename: &apos;[name].js[hash]&apos;    // 带hash值 [hash:8] 代表8位的hash,默认20位

3、publicPath: 复杂项目里会有一些构建出的资源需要异步加载，加载这些异步资源需要对应的URL

    output: {
        filename: &apos;[name]_[chunkhash:8].js&apos;,
        publicPath: &apos;https://cdn.example.com/assets/&apos;
    }

    发布到线上的HTML &lt;script src=&quot;https://cdn.example.com/assets/main.12345678.js&quot;&lt;/script&gt;

4、chunkFilename: 配置无入口的Chunk在输出时文件名称

    const path = require(&apos;path&apos;);
    module.exports = {
        output: {
            path: path.resolve(__dirname, &apos;./dist&apos;),
            publicPath: &apos;/dist/&apos;,
            filename: &apos;my-first-bundle.js&apos; 
        }
    }
</code></pre><h4 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h4><pre><code>rules配置模块的读取和解析，将所有引用资源(.css、.html、.scss、.jpg)作为模块处理

1、条件匹配: 通过test、include、exclude三个配置项来选中loader规则文件

    test: 匹配哪些文件

    include: 指定一个目录下的所有文件，可以加快webpack的搜索速度

    exclude: 排除某个目录，不在这个目录搜索文件

2、应用规则: 对选中的文件通过usr配置来应用loader

3、重置顺序: 默认从右向左执行, 通过enforce选项将其中一个loader的顺序放到最前或最后

module: {
rules: [
        {
    test: /(\.jsx|\.js)$/,
    use: {
      loader: &quot;babel-loader&quot;,        
                options: {
                    cacheDirectory: true,        // cacheDirectory用于缓存babel的编译结果，加快重新编译速度
                }
    },
            include: [path.resolve(__dirname, &apos;src)],        // 只在src目录下搜索js文件
  }
  {
    test: /\.css$/,
    use: [ &quot;style-loader&quot;, &quot;css-loader?minimize&quot;, &quot;sass-loader&quot; ],        // minimize 压缩css
            exclude: [/node_modules/]                // 除了node_modules目录不搜索
  }
]
</code></pre><p>  }</p>
<h4 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h4><pre><code>webpack启动后会从入口找出所有的依赖模块，resolve配置如何寻找模块对应的文件

1、alias 让模块引入变得简单

    import $ from &apos;/js/lib/jquery.min.js&apos;;      开发中需要引入jquery就需要写这类路径

    通过alias来解决
    resolve: {
        alias: {
            jquery: path.resolve(__dirname, &quot;/js/lib/jquery.min.js&quot;),
        },
         extensions: [&apos;&apos;, &apos;.js&apos;, &apos;.vue&apos;, &apos;.scss&apos;, &apos;.css&apos;]             //设置require或import的时候可以不需要带后缀
    }

    引用
    import $ from &apos;jquery&apos;;        // jquery就会被替换成依赖的路径
</code></pre><h4 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h4><pre><code>plugins扩展webpack功能，在构建流程里演讲稿钩子

一、webpack自带插件，可以直接使用

    pulgins: [
        new webpack.optimize.CommonsChunkPlugin({    // webpack自带插件在webpack.optimize内
            name: &apos;vendor&apos;,                                // 上面入口定义的节点组
            filename: &apos;jquery.vendor.js?[hash]&apos;     // 最后生成的文件名
        })
    ]


二、非webpack插件，需要先调用插件

    例: main.js

        require(&apos;./main.css&apos;)
        const show = require(&apos;./show.js)
        show(1,2)

    webpack.config.js
    // 将引用的css文件提取出来 
    const ExtractTextPlugin = require(&apos;extract-text-webpack-plugin&apos;);        

    pulgins: [
        new ExtractTextPlugin({
            filename: &apos;[name].[contenthash:8].css&apos;,            // main.11ad8d2c.css
            allChunks: true,
        })
    ]
</code></pre><h4 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h4><pre><code>webpack-dev-server - 创建一个本地服务，并能设置代理服务，并且能够实时重新加载

一、创建文件

    // 创建项目目录
    $ mkdir webpack_base_demo &amp;&amp; cd webpack_base_demo      

    // 创建配置文件
    $ touch README.md  .gitignore  .babelrc  webpack.config.js

    // 创建package.json
    $ npm init 

    // 配置.babelrc文件
    {
        &quot;presets&quot;: [&quot;react&quot;, &quot;env&quot;],
        &quot;env&quot;: {
            &quot;development&quot;: {
            &lt;!-- &quot;plugins&quot;: [[&quot;react-transform&quot;, {
                &quot;transforms&quot;: [{
                    &quot;transform&quot;: &quot;react-transform-hmr&quot;,
                    &quot;imports&quot;: [&quot;react&quot;],
                    &quot;locals&quot;: [&quot;module&quot;]
                }]
            }]] --&gt;
            }
        }
    }

二、安装webpack、webpack-dev-server

    $ npm i --save-dev webpack@3.10.0 webpack-dev-server            // webpack4.0 需要安装cli

三、安装loader

    // 如果使用react框架来做项目，先下载包
    $ npm i --save react react-dom

    $ npm i --save babel-plugin-react-transform react-transform-hmr   // babel的插件，在react热更新

        // .babelrc
        {
            &quot;presets&quot;: [&quot;react&quot;, &quot;env&quot;],
            &quot;env&quot;: {
                &quot;development&quot;: {
                    &quot;plugins&quot;: [
                        [
                            &quot;react-transform&quot;, {
                                &quot;transforms&quot;: [{
                                    &quot;transform&quot;: &quot;react-transform-hmr&quot;,
                                    &quot;imports&quot;: [&quot;react&quot;],
                                    &quot;locals&quot;: [&quot;module&quot;]
                                }]
                            }
                        ]
                    ]
                }
            }
        }

    // 使用Babel-loader来解析es6和react
    $ npm i --save babel-core babel-loader babel-preset-env babel-preset-react

    // vue-load - 解析和转换.vue文件，vue-template-compiler - 将vue-load提取出的HTML模板编译成可执行的JS代码，vue项目可直接安装vue-cli
    $ npm vue-load vue-template-compiler

    // jsx转换
    $ npm i --save jsx-loader

    // css模块化，可以在组件中引用指定模块的css文件， import &apos;./main.css&apos;
    $ npm i --save style-loader css-loader 

    // 可以将js和css中的导入的图片替换成正确的地址，同时将文件输出到对应的位置
    $ npm i --save file-loader

    // 将文件的图片经过base64编码后注入js或css中
    $ npm i --save url-loader    

    // 加载SVG
    $ npm i --save svg-loader

    // CSS预处理器  autoprefixer 自动加载前缀
    $ npm i --save less-loader sass-loader


四、安装插件

    1、html-webpack-plugin 解析html模板

        将入口js文件直接构建到指定的html中，并构建到build目录，这样不用手动在html引用js文件，和将html手动放到build目录下

        $ npm i --save html-webpack-plugin

    2、extract-text-webpack-plugin 单独打包css文件

        $ npm i --save extract-text-webpack-plugin

    3、open-browser-webpack-plugin   自动打开浏览器

        $ npm i --save open-browser-webpack-plugin

        var OpenBrowserWebpackPlugin = require(&apos;open-browser-webpack-plugin&apos;);
        plugin: [
          new OpenBrowserWebpackPlugin({ url: &apos;http://localhost:8080&apos; })
        ]

    4、webpack-spritesmith   雪碧图

        $ npm i --save webpack-spritesmith

        https://www.cnblogs.com/weiweisuo/p/6912740.html

    『 更多插件见 webpack插件类.md 』


五、package.json配置

    &quot;scripts&quot;: {
        &quot;start&quot;: &quot;webpack-dev-server --hot --inline --progress&quot;,
        &quot;build&quot;: &quot;webpack --progress --profile --colors --config&quot;
    },

    $ npm run start        // 启动开发环境


六、webpack.config.js、webpack.production.config 配置文件

    webpack.config.js 开发环境所用配置文件
    webpack.pub.config.js  生产环境所用配置文件

    /**
     * User: siguang
     * Date: 2016/12/28
     * Time: 15:04
     */
    const webpack = require(&apos;webpack&apos;);
    const path = require(&apos;path&apos;);
    const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)
    // const ExtractTextPlugin = require(&quot;extract-text-webpack-plugin&quot;); // 单独打包CSS
    const OpenBrowserWebpackPlugin = require(&apos;open-browser-webpack-plugin&apos;);
    // 清除目录
    const CleanWebpackPlugin = require(&apos;clean-webpack-plugin&apos;);
    // 提取公用
    const CommonsChunkPlugin = require(&apos;webpack/lib/optimize/CommonsChunkPlugin&apos;);

    /*  文件路径配置 */
    const basePath = __dirname;
    const appPath = path.resolve(basePath, &apos;src&apos;);
    const buildPath = path.resolve(basePath, &apos;build&apos;);

    /* libs 目录下的库文件 */
    const libsPath = path.resolve(basePath, &apos;src/libs&apos;);
    const jquery = path.resolve(libsPath, &apos;jquery.min&apos;)

    // webpack配置对象
    module.exports = {

        // 入口文件
        entry: {
                app: path.resolve(appPath, &apos;js/index.js&apos;),
                list: path.resolve(appPath, &apos;js/list.js&apos;)
        },

        // 出口文件
        output: {
                path: buildPath,
                filename: &apos;/js/[name].min.js?[hash]&apos;,
                chunkFilename: &quot;[name].min.js?[hash]&quot;
        },

        // 加载器配置
        module: {
            loaders: [

                // 处理require()引入的css文件，并将代码显示到页面的&lt;style|中
                { test: /\.css$/, loader: &quot;style-loader!css-loader&quot; },

                // 将jsx文件转成js文件
                { test: /\.js$/, loader: &apos;jsx-loader?harmony&apos;},

                // 将scss文件转成css文件
                { test: /\.scss$/, loader: &apos;style!css!sass?sourceMap&apos;},

                // ?limit=8192  limit设置小于8k的图片转成64位编码，大小8于不会被转码
                { test: /\.(png|jpg|woff|eot|ttf|svg|gif)$/, loader: &apos;url-loader?limit=8192&apos;},

                // ES6 转 ES5
                {    
                    test: /\.js?$/,
                    loader: &apos;babel-loader&apos;,
                    query: {
                        presets: [&apos;es2015&apos;]
                    }
                }   
            ]
        },

        // 插件
        plugins: [
            // 清空build目录
            new CleanWebpackPlugin(buildPath), 

            // 热启动
            new webpack.HotModuleReplacementPlugin(),

            // 自动开启浏览器
            new OpenBrowserWebpackPlugin({ url: &apos;http://localhost:5000&apos; })

            // 压缩打包的文件
            // new webpack.optimize.UglifyJsPlugin({
            //     compress: {
            //         //supresses warnings, usually from module minification
            //         warnings: false
            //     }
            // }),

            // 将vendor中的库合并到一起
            new CommonsChunkPlugin({
                // 从哪些Chunk 中提取
                chunks: [&apos;main&apos;, &apos;list&apos;],
                // 提取的公共部分形成一个chunk
                name: &apos;common&apos;
            }),     

            // html
            new HtmlWebpackPlugin({
                // 改变页面的&lt;title|标签的内容 
                title: &apos;Hello World app&apos;,                   // 页面调用&lt;%= htmlWebpackPlugin.options.title %|
                // 模版地址
                template: path.resolve(appPath, &apos;index.html&apos;),
                // 构建后的文件名和目录
                filename: &apos;index.html&apos;,
                //chunks这个参数告诉插件要引用entry里面的哪几个入口
                chunks:[&apos;app&apos;,&apos;vendor&apos;],
                //要把script插入标签里
                inject:&apos;body&apos;
            }),

            new HtmlWebpackPlugin({
                // 改变页面的&lt;title|标签的内容 
                title: &apos;Hello World appList&apos;, 
                // 模版地址
                template: path.resolve(appPath, &apos;list.html&apos;),
                // 构建后的文件名和目录
                filename: &apos;list.html&apos;,
                //chunks这个参数告诉插件要引用entry里面的哪几个入口
                chunks:[&apos;list&apos;,&apos;vendor&apos;],
                //要把script插入标签里
                inject:&apos;body&apos;
            }),                
        ],

        // 查找依赖
        resolve:{
            jquery: path.resolve(__dirname, &apos;src/utils/jquery.min.js&apos;), 
            // require或alias时不需要写后缀
            // extensions: [&quot;.js&quot;, &quot;.jsx&quot;, &quot;.css&quot;, &quot;.json&quot;],
        },

        // 启动文件侦听
        watch: true,      // 这里配置watch与在package.json中的script中设置 webpack --watch一样
        watchOptions: {
            // 不侦听的文件夹
            ignored: &apos;/node_modules/&apos;,  
            // 文件变化后300ms后在编译，防止更新太快导致重新编译太快
            aggregateTimeout: 300,
            // 判断文件变化 
            poll: 1000
        },

        devtool: &apos;source-map&apos;,

        // webpack-dev-server 配置
        devServer: {
        port: 8090,               // 端口
            contentBase: &apos;build&apos;,     // 内容目录
            hot: true,                    // 启用webpack热替换
            inline: true,
            compress: true,                  // 一切服务都启用gzip 压缩
            proxy: {
                &apos;/api/*&apos;: {                // 以api开头的走代理接口
                    target: &apos;http://wwww.we.com&apos;,
                    pathRewrite: {
                        &apos;^/api/&apos;: &apos;/&apos;    // api指向target的根目录
                    },
                    changeOrigin: true,
                    secure: false
                }
            },
            historyApiFallback:{
                rewrites:[        // 不存在的路由跳到404页面
                    {
                        from: /./,
                        to: &apos;404.html&apos;
                    }
                ]
            }
        }
    }


两套配置:

    webpack.development.config.js            // 开发配置
    webpack.production.config.js            // 生产配置

    script: {
        &quot;build&quot;: &quot;webpack --config production.config.js&quot;,
        &quot;dev&quot;: &quot;webpack --config development.config.js&quot;
    }
</code></pre><h4 id="webpack-dev-server-参数"><a href="#webpack-dev-server-参数" class="headerlink" title="webpack-dev-server 参数"></a>webpack-dev-server 参数</h4><pre><code>一、在webpack.config.js中配置

    // 生成Source Map
    devtool: &apos;source-map&apos;,

    devServer: {
        // 端口
        port: 8090,               

        // 默认目录
        contentBase: &apos;build&apos;,

        // 启用webpack热替换
        hot: true,                // 必须要有HotModuleReplacementPlugin插件才能完全启用HMR

        //           
        inline: true,

        // 启用gzip压缩
        compress: true,                  

        // 配置代理
        proxy: {
            &apos;/api/*&apos;: {                // 以api开头的走代理接口
                target: &apos;http://goucai.diyicai.com&apos;,
                pathRewrite: {
                    &apos;^/api/&apos;: &apos;/&apos;    // api指向target的根目录
                },
                changeOrigin: true,
                secure: false
            }
        },

        // 配置路由的跳转，404跳转
        historyApiFallback:{
            rewrites:[        // 不存在的路由跳到404页面
                {
                    from: /./,
                    to: &apos;404.html&apos;
                }
            ]
        }

        // 设置响应头
        headers: { &apos;X-Token&apos;: &apos;bar&apos; }

        // 设置https
        https: true    使用https，也可以配置证书，见资料第2章
    }


二、参数是加到package.json的script中的  &quot;start&quot;: &quot;webpack-dev-server --hot --inline --progress&quot;,

    webpack-dev-server - 在 localhost:8080 建立一个 Web 服务器

    webpack-dev-server --devtool eval - 为你的代码创建源地址。当有任何报错的时候可以让你更加精确地定位到文件和行号

    webpack-dev-server --progress - 显示合并代码进度

    webpack-dev-server --colors - 命令行中显示颜色

    webpack-dev-server --content-base build  // webpack-dev-server服务会默认以当前目录伺服文件，如果设置了content-base的话，服务的根路径则为build目录

    webpack-dev-server --inline  可以自动加上dev-server的管理代码，实现热更新

    webpack-dev-server --hot  开启代码热替换，可以加上HotModuleReplacementPlugin

    webpack-dev-server --port 3000 设置服务端口
</code></pre><p>| <a href="https://doc.webpack-china.org/concepts/" target="_blank" rel="noopener">https://doc.webpack-china.org/concepts/</a>        webpack中文网 v3.10.0<br>| <a href="https://www.jianshu.com/p/42e11515c10f" target="_blank" rel="noopener">https://www.jianshu.com/p/42e11515c10f</a><br>| <a href="http://webpack.wuhaolin.cn/" target="_blank" rel="noopener">http://webpack.wuhaolin.cn/</a>                            // book<br>| <a href="https://webpack.js.org/plugins/" target="_blank" rel="noopener">https://webpack.js.org/plugins/</a>                // 自带插件<br>| <a href="https://zhuanlan.zhihu.com/p/32148338" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/32148338</a><br>| <a href="https://blog.csdn.net/keliyxyz/article/details/51571386" target="_blank" rel="noopener">https://blog.csdn.net/keliyxyz/article/details/51571386</a><br>| <a href="http://react-china.org/t/webpack-output-filename-output-chunkfilename/2256/2" target="_blank" rel="noopener">http://react-china.org/t/webpack-output-filename-output-chunkfilename/2256/2</a>   // output.filename 和output.chunkFilename<br>| <a href="http://www.alloyteam.com/2016/02/code-split-by-routes/" target="_blank" rel="noopener">http://www.alloyteam.com/2016/02/code-split-by-routes/</a>  按需加载<br>|<br>| 插件<br>| <a href="http://www.cnblogs.com/haogj/p/5160821.html" target="_blank" rel="noopener">http://www.cnblogs.com/haogj/p/5160821.html</a>     // html-webpack-plugin html多页面构建<br>|<br>| 热更新<br>| <a href="https://github.com/gaearon/react-hot-loader" target="_blank" rel="noopener">https://github.com/gaearon/react-hot-loader</a>    // react<br>| <a href="https://github.com/vuejs/vue-loader" target="_blank" rel="noopener">https://github.com/vuejs/vue-loader</a>            // vue</p>

        
    </section>
</article>



<div class="comments">
    <div id="disqus_thread">
        <p class="comment-tips">国内查看评论需要代理~</p>
    </div>
    <script>
    window.disqus_config = function () {
        this.language = 'zh';
        this.page.url = 'http://siguang1983.github.io/2016/11/02/webpack/';
        this.page.title = 'webpack';
        this.page.identifier = '2016/11/02/webpack/';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://name.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>
</footer>

<script type="text/javascript" src="//s13.cnzz.com/z_stat.php?id=1234567890&amp;web_id=1234567890"></script>


    </div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    
    <script type="text/javascript" src="/js/scrollspy.min.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var nodes = {
                nav: $('#nav'),
                aside: $('#aside'),
                navTags: $('#nav-tags')
            };

            $('#open-panel, #aside-mask').on('click', function() {
                nodes.aside.toggleClass('panel-show');
            });
            $('#nav-tag').on('click', function(event) {
                event.preventDefault();console.log(nodes.navTags.attr('class'))
                nodes.navTags.toggleClass('tag-show');console.log(nodes.navTags.attr('class'))
            })/*.hover(function() {
                nodes.navTags.addClass('tag-show');
            }, function() {
                nodes.navTags.removeClass('tag-show');
            });*/

            
            $(document.body).scrollspy({target: '#aside-inner'});
            
        });
    </script>

</body>
</html>
