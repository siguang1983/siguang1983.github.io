<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>VueJS之-“Vuex篇“（四） | 大排档</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="VuexVuex借鉴了Flux和Redux设计思想.  优点:     Vue组件父子之间通过$on、$emit自定义事件来进行通信     Vuex可以解决同级组件之间无法传递消息 执行步骤Store: 定义仓库，包含state对象，组件通过getter从store读取数据，通过Getter  核心模块:      1、state: 定义存储状态      2、getter: 对数据进行过滤，获">
<meta name="keywords" content="Vue">
<meta property="og:type" content="article">
<meta property="og:title" content="VueJS之-“Vuex篇“（四）">
<meta property="og:url" content="http://siguang1983.github.io/2016/10/26/VueJS之-“Vuex篇“（四）/index.html">
<meta property="og:site_name" content="大排档">
<meta property="og:description" content="VuexVuex借鉴了Flux和Redux设计思想.  优点:     Vue组件父子之间通过$on、$emit自定义事件来进行通信     Vuex可以解决同级组件之间无法传递消息 执行步骤Store: 定义仓库，包含state对象，组件通过getter从store读取数据，通过Getter  核心模块:      1、state: 定义存储状态      2、getter: 对数据进行过滤，获">
<meta property="og:updated_time" content="2017-12-25T07:44:21.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="VueJS之-“Vuex篇“（四）">
<meta name="twitter:description" content="VuexVuex借鉴了Flux和Redux设计思想.  优点:     Vue组件父子之间通过$on、$emit自定义事件来进行通信     Vuex可以解决同级组件之间无法传递消息 执行步骤Store: 定义仓库，包含state对象，组件通过getter从store读取数据，通过Getter  核心模块:      1、state: 定义存储状态      2、getter: 对数据进行过滤，获">
  
    <link rel="alternate" href="/atom.xml" title="大排档" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">大排档</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://siguang1983.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-VueJS之-“Vuex篇“（四）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/26/VueJS之-“Vuex篇“（四）/" class="article-date">
  <time datetime="2016-10-26T02:40:24.000Z" itemprop="datePublished">2016-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      VueJS之-“Vuex篇“（四）
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h4><pre><code>Vuex借鉴了Flux和Redux设计思想.

优点:
    Vue组件父子之间通过$on、$emit自定义事件来进行通信
    Vuex可以解决同级组件之间无法传递消息
</code></pre><h4 id="执行步骤"><a href="#执行步骤" class="headerlink" title="执行步骤"></a>执行步骤</h4><pre><code>Store: 定义仓库，包含state对象，组件通过getter从store读取数据，通过Getter

核心模块:

    1、state: 定义存储状态

    2、getter: 对数据进行过滤，获取state数据，在计算属性中获取state的值

    3、mutation: 更改 Vuex 的 store 中的state值的唯一方法是提交 mutation

    4、action: 类似于 mutation，不同在于可以包含任意异步操作，Action通过commit()方法来调用mutation中的方法在改变来改变state的值，而不是直接改变state中的值

            分发Action: store.dispatch()方法触发

    5、modules: 如果应用过大，便可以使用 modules 来分割管理，不至于 store 变得非常臃肿


模块示例详解:

一、state: 

    用来存储数据，如果在组件中获取state中的数据，可以通过两种方法来获取: 计算属性computed 和 Getters

    在组件中显示state值可以通过computed来获取:

        &lt;template&gt;
            &lt;div class=&quot;box&quot;&gt;
                {{getSideData}}
            &lt;/div&gt;
        &lt;/template&gt;

        方法1: 计算属性中获取

        computed: {
            getSideData () {
                return this.$store.state.sideData;            // 当getSideData的值改变就会显示出来
            }
        }


        方法2: mapState函数获取

        import { mapState } from &apos;vuex&apos;;        // 引用mapState()

        export default {
            name: &apos;side&apos;,
            computed: {
                ...mapState({    // 对象展开运算符
                    getSideData: (state) =&gt; {
                        return state.sideData
                    }
                })
            }
        }

        getters.js
            export const sideData = (state) =&gt; {
                return state.sideData;
            } 


2、Getter

    获取state中数据的第二种方法

    getters.js中定义获取state的方法: 

        export const sideData = (state) =&gt; {
            return state.sideData;
        }

    组件中调用

        1）computed方式

            computed: {
                getSideData(){
                    return this.$store.getters.sideData;        // $store.getters下找到定义的sideDap
                }
            }

        2）通过mapGetters获取

            &lt;template&gt;
                &lt;div&gt;{{ getSideData }}&lt;/div&gt;
            &lt;/tempate&gt;

            import { mapState, mapGetters } from &apos;vuex&apos;;

            computed: {
                ...mapGetters({
                    getSideData: &quot;sideData&quot;            // 映射到getters.js中定义的sideData, 并将数据返回给getSideData
                })
            }

3、Mutations

    用来更改Vuex中state的数据，它是同步的

    1、commit()触发Action, Action触发mutation

        定义mutations 

            export default {
                changeSideData(state, sideJson){
                    state.sideData.push(sideJson)
                }
            }

        触发
            methods:{
                addSideData(){
                    let side = {
                        id: 1,
                        name: this.name,
                        introduce: this.introduce
                    }
                    this.$store.commit(&apos;changeSideData&apos;, side);
                }
            }


    2、使用mapMutations() 来定义改变


4、Actions

    Actions提交到 Mutations中，而不能直接改变state的值

    Actions可以包含异步操作，Mutations是同步的

    1）Example

        定义actions

            export const holderSilde = ({commit}, {name, introduce}) =&gt; {    
                // {name, introduce} 这里注意一定对象传过来，这里为解析赋值写法，函数不接收第三个参数
                var side = {
                    id: 1,
                    name: name,
                    introduce: introduce
                }
                commit(&apos;changeSideData&apos;, side)
            }


        调用 分发dispatch

            methods:{
                addSideData(){
                    // 第二个为传过去的参数
                    this.$store.dispatch(&apos;holderSilde&apos;, {name: this.name, introduce: this.introduce});
                }
            }


5、Modules

    Vuex可以将Store分割到各模块，每个模块都有自己的store、mutations、actions、getters

    const moduleA = {
        state: { ... },
        mutations: { ... },
        actions: { ... },
        getters: { ... }
    }

    const moduleB = {
        state: { ... },
        mutations: { ... },
        actions: { ... }
    }

    const store = new Vuex.Store({
        modules: {
            a: moduleA,
            b: moduleB
        }
    })

    store.state.a // -&gt; moduleA 的状态
    store.state.b // -&gt; moduleB 的状态
</code></pre><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><pre><code>1、App.vue:

    &lt;template&gt;
        &lt;div&gt;
            &lt;Display&gt;&lt;/Display&gt;
            &lt;Increment&gt;&lt;/Increment&gt;
        &lt;/div&gt;
    &lt;/template&gt;

    &lt;script&gt;
        import Display from &apos;./components/Display.vue&apos;
        import Increment from &apos;./components/Increment.vue&apos;
        import store from &apos;./vuex/store&apos;

        export default {
            components: {
                Display,
                Increment
            },
            store           // 在根组件加入store
        }
    &lt;/script&gt;

    &lt;style&gt;
    body {
        font-family: Helvetica, sans-serif;
    }
    &lt;/style&gt;


2、Display.vue:

    &lt;template&gt;
        &lt;div&gt;
            &lt;h3&gt;Count is {{ counterValue }}&lt;/h3&gt;
        &lt;/div&gt;
    &lt;/template&gt;

    &lt;script&gt;
        import { getCount } from &apos;../vuex/getters&apos;

        export default {
            vuex: {
                getters: {
                    counterValue: getCount
                }
            }
        }
    &lt;/script&gt;


3、Increment.vue

    &lt;template&gt;
        &lt;div&gt;
        &lt;button @click=&quot;increment&quot;&gt;Increment +1&lt;/button&gt;
        &lt;/div&gt;
    &lt;/template&gt;

    &lt;script&gt;
        import { incrementCounter } from &apos;../vuex/action&apos;

        export default {

            vuex: {
                actions: {
                    increment: incrementCounter
                }
            }

        }
    &lt;/script&gt;


4、main.js

    import Vue from &apos;vue&apos; 
    import App from &apos;./App.vue&apos;

    new Vue({
        el: &apos;body&apos;,
        components: { 
            App
        }
    })


5、store.js

    import Vue from &apos;vue&apos;
    import Vuex from &apos;vuex&apos;

    // 引用vuex
    Vue.use(Vuex);

    // 启动时的初始状态
    const state = {
        // 放置初始化状态
        count: 0
    }

    const mutations = {
        // 放置要变更的函数
        INCREMENT(state, amount){
            state.count = state.count + amount;
        }
    }

    export default new Vuex.Store({
        state,
        mutations
    })


6、action.js

    // action 会收到 store 作为它的第一个参数
    // 既然我们只对事件的分发（dispatch 对象）感兴趣。（state 也可以作为可选项放入）
    // 我们可以利用 ES6 的解构（destructuring）功能来简化对参数的导入
    export const incrementCounter = function ({ dispatch, state }) {
        console.log(dispatch, state)
        dispatch(&apos;INCREMENT&apos;, 1)
    }


7、getter.js

    // 这个 getter 函数会返回 count 的值
    // 在 ES6 里你可以写成: 
    // export const getCount = state =&gt; state.count
    export function getCount(state){
        return state.count;
    }
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://siguang1983.github.io/2016/10/26/VueJS之-“Vuex篇“（四）/" data-id="cjdu4wpww001ochwr83t54h1g" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/11/02/webpack/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          webpack
        
      </div>
    </a>
  
  
    <a href="/2016/10/23/VueJS之-“插件篇“（三）/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">VueJS 之 “插件篇“（三）</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/EggJS/">EggJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML-CSS/">HTML+CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP详解/">HTTP详解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Less/">Less</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/">React Native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sass/">Sass</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Weex/">Weex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mock数据/">mock数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/函数式编程/">函数式编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端优化/">前端优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端插件类/">前端插件类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端构建工具/">前端构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微信小程序/">微信小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/插件/">插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务器/">服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务端开发/">服务端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板引擎/">模板引擎</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器内核/">浏览器内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端/">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/经济学/">经济学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/金融/">金融</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/EggJS/" style="font-size: 15px;">EggJS</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/HTML-CSS/" style="font-size: 12.5px;">HTML+CSS</a> <a href="/tags/HTTP详解/" style="font-size: 10px;">HTTP详解</a> <a href="/tags/Less/" style="font-size: 10px;">Less</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Node-js/" style="font-size: 20px;">Node.js</a> <a href="/tags/React/" style="font-size: 12.5px;">React</a> <a href="/tags/React-Native/" style="font-size: 12.5px;">React Native</a> <a href="/tags/Sass/" style="font-size: 10px;">Sass</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/Weex/" style="font-size: 10px;">Weex</a> <a href="/tags/javascript/" style="font-size: 17.5px;">javascript</a> <a href="/tags/mock数据/" style="font-size: 10px;">mock数据</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/函数式编程/" style="font-size: 10px;">函数式编程</a> <a href="/tags/前端优化/" style="font-size: 10px;">前端优化</a> <a href="/tags/前端插件类/" style="font-size: 10px;">前端插件类</a> <a href="/tags/前端构建工具/" style="font-size: 12.5px;">前端构建工具</a> <a href="/tags/微信小程序/" style="font-size: 10px;">微信小程序</a> <a href="/tags/插件/" style="font-size: 10px;">插件</a> <a href="/tags/数据库/" style="font-size: 12.5px;">数据库</a> <a href="/tags/服务器/" style="font-size: 10px;">服务器</a> <a href="/tags/服务端开发/" style="font-size: 10px;">服务端开发</a> <a href="/tags/模板引擎/" style="font-size: 12.5px;">模板引擎</a> <a href="/tags/浏览器内核/" style="font-size: 10px;">浏览器内核</a> <a href="/tags/移动端/" style="font-size: 10px;">移动端</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/经济学/" style="font-size: 10px;">经济学</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/金融/" style="font-size: 10px;">金融</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/10/23/微信小程序、公众号开发/">微信小程序、公众号开发</a>
          </li>
        
          <li>
            <a href="/2017/09/20/numjucks模板/">numjucks模板</a>
          </li>
        
          <li>
            <a href="/2017/09/20/Jade模板/">Jade 模板</a>
          </li>
        
          <li>
            <a href="/2017/07/01/前端算法/">前端算法</a>
          </li>
        
          <li>
            <a href="/2017/07/01/Rap的使用和mock数据/">Rap的使用和mock数据</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 siguang(厨子)<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>